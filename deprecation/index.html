<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Deprecations & Current Refactoring - LLMIR</title>
<meta name=description content="Large Language Model IR Compiler Framework"><meta name=generator content="Hugo 0.129.0"><link href=https://chenxingqiang.github.io/llmir-www/index.xml rel=alternate type=application/rss+xml><link rel=canonical href=https://chenxingqiang.github.io/llmir-www/deprecation/><link rel=stylesheet href=https://chenxingqiang.github.io/llmir-www/css/theme.css><script src=https://use.fontawesome.com/releases/v5.0.6/js/all.js></script><link rel=stylesheet href=https://chenxingqiang.github.io/llmir-www/css/chroma.min.css><script src=https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js></script><script src=https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js></script><script src=https://chenxingqiang.github.io/llmir-www/js/bundle.js></script><script type=text/javascript src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type=text/x-mathjax-config>
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$', '$'] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    }
  });
</script><link rel=apple-touch-icon sizes=180x180 href="/apple-touch-icon.png?v=1"><link rel=icon type=image/png sizes=32x32 href="/favicon-32x32.png?v=1"><link rel=icon type=image/png sizes=16x16 href="/favicon-16x16.png?v=1"><link rel=manifest href="/site.webmanifest?v=1"><link rel=mask-icon href="/safari-pinned-tab.svg?v=1" color=#3775e0><link rel="shortcut icon" href="/favicon.ico?v=1"><meta name=msapplication-TileColor content="#2d89ef"><meta name=theme-color content="#ffffff"><link rel=icon href=/favicon.svg type=image/svg+xml sizes=any><style>:root{}</style></head><body><div class=container><header><h1><div><img src=https://chenxingqiang.github.io/llmir-www//mlir-logo.png width=40px align=absmiddle>
LLMIR</div></h1><span class=version>Version 0.0.1</span><p class=description>Large Language Model IR Compiler Framework</p></header><div class=global-menu><nav><ul><li><a href=/llmir-www/governance/>Governance</a></li><li class=parent><a href>Community<i class="fas fa-angle-right"></i></a><ul class=sub-menu><li class=child><a href=https://llvm.discourse.group/c/llmir/31>Forums</a></li><li class=child><a href=https://discord.gg/xS7Z362>Chat</a></li></ul></li><li><a href=/llmir-www/getting_started/Debugging/>Debugging Tips</a></li><li><a href=/llmir-www/getting_started/Faq/>FAQ</a></li><li class=parent><a href=https://github.com/chenxingqiang/llmir>Source<i class="fas fa-angle-right"></i></a><ul class=sub-menu><li class=child><a href=/llmir-www/doxygen/>Doxygen</a></li><li class=child><a href=https://github.com/chenxingqiang/llmir>GitHub</a></li></ul></li><li><a href=https://github.com/chenxingqiang/llmir/issues>Bugs</a></li><li><a href=https://github.com/chenxingqiang/llmir-www/tree/main/website/static/LogoAssets>Logo Assets</a></li><li><a href=https://www.youtube.com/LLMIRCompiler>Youtube Channel</a></li></ul></nav></div><div class=content-container><main><h1>Deprecations & Current Refactoring</h1><p>This page collects current deprecations in MLIR of API and features we intend
to remove soon, as well as large refactoring an migration on-going.
We try to list these here for the purpose of helping downstream users keeping
up with MLIR development.</p><h2 id=deprecated>Deprecated</h2><h3 id=use-matchandrewrite-instead-of-match--rewrite>Use <code>matchAndRewrite</code> instead of <code>match</code> / <code>rewrite</code></h3><p>The <code>match</code> and <code>rewrite</code> functions of <code>RewritePattern</code> and <code>ConversionPattern</code>
are deprecated. Use the combined <code>matchAndRewrite</code> instead.</p><h2 id=on-going-refactoring--large-changes>On-going Refactoring & large changes</h2><h1 id=past-deprecation-and-refactoring>Past Deprecation and Refactoring</h1><h2 id=llvm-17>LLVM 17</h2><h3 id=promised-interface-and-the-need-to-explicitly-register-inlinerextension-for-the-funcdialect>&ldquo;Promised Interface&rdquo; and the need to explicitly register InlinerExtension for the <code>FuncDialect</code>.</h3><p>We&rsquo;re tightening the contract around injecting interfaces into the system externally, starting with
<code>DialectInterface</code>. As an important visible change at the moment is that if you&rsquo;re using the inliner
with the <code>FuncDialect</code>, you need to call <code>func::registerAllExtensions(registry);</code> when setting up
your <code>MLIRContext</code>.</p><h3 id=properties--changes-to-the-generic-printing-format>Properties && changes to the generic printing format</h3><p>See on
<a href=https://discourse.llvm.org/t/rfc-introducing-mlir-operation-properties/67846/19>Discourse</a>.</p><p>Properties is a new feature in MLIR that will allow to separate the storage of
inherent attributes from the discardable ones. One key visible change is the
generic assembly format which gain a new attribute entry in-between <code>&lt;</code> <code>></code>.</p><h3 id=preloaddialectincontext-has-been-deprecated-for-1y-and-was-removed><code>preloadDialectInContext</code> has been deprecated for >1y and was removed</h3><p>See
<a href=https://github.com/llvm/llvm-project/commit/9c8db444bc85>https://github.com/llvm/llvm-project/commit/9c8db444bc85</a></p><p>If you have an mlir-opt tool and you’re still depending on
<code>preloadDialectInContext</code>, you need to revisit your pipeline. This option
used with mlir-opt is hiding issues with the pipeline, and indications of
missing getDependentDialects().
<a href=https://discourse.llvm.org/t/psa-preloaddialectincontext-has-been-deprecated-for-1y-and-will-be-removed/68992>Discussion on Discourse</a></p><h3 id=migrating-mlir-opt-like-tools-to-use-mliroptmainconfig>Migrating <code>mlir-opt</code>-like tools to use <code>MlirOptMainConfig</code></h3><p>See
<a href=https://github.com/llvm/llvm-project/commit/ffd6f6b91a3>https://github.com/llvm/llvm-project/commit/ffd6f6b91a3</a></p><p>If your <code>mlir-opt</code>-like tool is using the
<code>MlirOptMain(int argc, char **argv, ...)</code> entry point you won’t be affected,
otherwise, see the
<a href=https://discourse.llvm.org/t/psa-migrating-mlir-opt-like-tools-to-use-mliroptmainconfig/68991>Discussion on Discourse</a></p><h3 id=deprecation-of-gpu-to-cubinhsaco-in-favor-of-gpu-compilation-attributes>Deprecation of <code>gpu-to-(cubin|hsaco)</code> in favor of GPU compilation attributes</h3><p><a href=https://mlir.llvm.org/docs/Dialects/GPU/#gpu-compilation>GPU compilation attributes</a> are a completely new mechanism for handling the compilation
of GPU modules down to binary or other formats in an extensible way. This mechanism lifts
many current restrictions the GPU serialization passes had, like being present only if the
CUDA driver is there or not linking to LibDevice.</p><p>One key difference is the usage of <code>ptxas</code> or the <code>nvptxcompiler</code> library for compiling PTX
to binary; hence the CUDATollkit is required for generating binaries.</p><p>For these attributes to work correctly, making registration calls to <code>registerNVVMTargetInterfaceExternalModels</code>,
<code>registerROCDLTargetInterfaceExternalModels</code> and <code>registerOffloadingLLVMTranslationInterfaceExternalModels</code> are necessary.</p><p>The passes <code>gpu-to-(cubin|hsaco)</code> will be removed in a future release.</p><h2 id=llvm-18>LLVM 18</h2><h3 id=port-uses-of-llvm-dialect-to-opaque-pointers>Port uses of LLVM Dialect to opaque pointers</h3><p>LLVM 17 has stopped officially supporting typed pointers, and MLIRs LLVM Dialect
is now in the process of dropping the support as well. This was announced back
in February 2023 (
<a href=https://discourse.llvm.org/t/psa-in-tree-conversion-passes-can-now-be-used-with-llvm-opaque-pointers-please-switch-your-downstream-projects/68738>PSA</a>)
, and now the final steps, i.e., removing the typed pointers, have started
(
<a href=https://discourse.llvm.org/t/psa-removal-of-typed-pointers-from-the-llvm-dialect/74502>PSA</a>).
If you are still targeting LLVM dialect with typed pointers, an update to
support opaque pointers will be necessary.</p><h2 id=llvm-19>LLVM 19</h2><h3 id=removal-of-gpu-to-cubinhsaco-in-favor-of-gpu-compilation-attributes>Removal of <code>gpu-to-(cubin|hsaco)</code> in favor of GPU compilation attributes</h3><p><strong>Notice: The passes <code>gpu-to-(cubin|hsaco)</code> have been removed from the monorepo, use target attributes instead. See the LLVM 17 section on this page for more information.</strong></p><h2 id=llvm-20>LLVM 20</h2><h3 id=removal-of-vectorreshape>Removal of <code>vector.reshape</code></h3><p>This operation was added back in 2019, and since then, no lowerings or uses have
been implemented in upstream MLIR or any known downstream projects. Due to this
lack of use, it was decided that the operation should be removed.</p><p><a href=https://discourse.llvm.org/t/rfc-should-vector-reshape-be-removed/80478>Discussion on Discourse</a></p><h2 id=llvm-21>LLVM 21</h2><h3 id=use-the-free-function-variants-for-dyn_castcastisa>Use the free function variants for <code>dyn_cast</code>/<code>cast</code>/<code>isa</code>/&mldr;</h3><p>When casting attributes or type, use the free functions variants, e.g.,
<code>dyn_cast&lt;T>(x)</code>, <code>isa&lt;T>(x)</code>, etc. Use of the cast methods variants (e.g.,
<code>x.dyn_cast&lt;T>()</code>) should be avoided in new code as we removed these
methods in
<a href=https://github.com/llvm/llvm-project/pull/135556>https://github.com/llvm/llvm-project/pull/135556</a>.</p><p><a href=https://discourse.llvm.org/t/preferred-casting-style-going-forward/68443>Discussion on Discourse</a></p><div class=edit-meta><br><a href=https://github.com/chenxingqiang/llmir-www//edit/main/docs/content/ class=edit-page><i class="fas fa-pen-square"></i> Edit on GitHub</a></div><nav class=pagination><a class="nav nav-prev" href=https://chenxingqiang.github.io/llmir-www/users/ title="Users of MLIR"><i class="fas fa-arrow-left" aria-hidden=true></i> Prev - Users of MLIR</a>
<a class="nav nav-next" href=https://chenxingqiang.github.io/llmir-www/getting_started/ title="Getting Started">Next - Getting Started <i class="fas fa-arrow-right" aria-hidden=true></i></a></nav><footer><p class=powered>Powered by <a href=https://gohugo.io>Hugo</a>. Theme by <a href=https://themes.gohugo.io/hugo-theme-techdoc/>TechDoc</a>. Designed by <a href=https://github.com/thingsym/hugo-theme-techdoc>Thingsym</a>.</p></footer></main><div class=sidebar><nav class=slide-menu><ul><li><a href=https://chenxingqiang.github.io/llmir-www/>Home</a></li><li><a href=https://chenxingqiang.github.io/llmir-www/governance/>Governance</a></li><li><a href=https://chenxingqiang.github.io/llmir-www/pubs/>LLMIR Related Publications</a></li><li><a href=https://chenxingqiang.github.io/llmir-www/users/>Users of MLIR</a></li><li class=active><a href=https://chenxingqiang.github.io/llmir-www/deprecation/>Deprecations & Current Refactoring</a></li><li class=has-sub-menu><a href=https://chenxingqiang.github.io/llmir-www/getting_started/>Getting Started<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://chenxingqiang.github.io/llmir-www/getting_started/ReportingIssues/>Reporting Issues</a></li><li><a href=https://chenxingqiang.github.io/llmir-www/getting_started/Debugging/>Debugging Tips</a></li><li><a href=https://chenxingqiang.github.io/llmir-www/getting_started/Faq/>FAQ</a></li><li><a href=https://chenxingqiang.github.io/llmir-www/getting_started/Contributing/>How to Contribute</a></li><li><a href=https://chenxingqiang.github.io/llmir-www/getting_started/openprojects/>Open Projects</a></li><li><a href=https://chenxingqiang.github.io/llmir-www/getting_started/Glossary/>Glossary</a></li><li><a href=https://chenxingqiang.github.io/llmir-www/getting_started/TestingGuide/>Testing Guide</a></li><li><a href=https://chenxingqiang.github.io/llmir-www/getting_started/DeveloperGuide/>Developer Guide</a></li></ul></li></ul></nav><div class=sidebar-footer></div></div></div><a href=# id=backtothetop-fixed class=backtothetop data-backtothetop-duration=600 data-backtothetop-easing=easeOutQuart data-backtothetop-fixed-fadein=1000 data-backtothetop-fixed-fadeout=1000 data-backtothetop-fixed-bottom=10 data-backtothetop-fixed-right=20><span class="fa-layers fa-fw"><i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i></span></a></div></body></html>